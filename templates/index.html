<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>CESM2 Visualizer</title>
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <!-- Leaflet -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
        <!-- Make sure you put this AFTER Leaflet's CSS --> 
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
        <!-- Local css -->
        <style>
            html, body {
                height: 100%;
                margin: 0;
            }
            .leaflet-container {
                height: 400px;
                width: 600px;
                max-width: 100%;
                max-height: 100%;
            }
        </style>
    </head>

    <body>
        <select name="Variable" id="var_select">
            {% for c in var_list %}
                <option value="{{c}}">{{c}}</option>
            {% endfor %}
        </select>
        <select name="Forcing Type" id="forcing_type">
            {% for f in forcing_types %}
                <option value="{{f}}">{{f}}</option>
            {% endfor %}
        </select>
        <div id="map" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" style="position: relative;" tabindex="0">
            <script>
            // Basemaps
            var Stamen_Terrain = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.{ext}', {
                attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                subdomains: 'abcd',
                minZoom: 0,
                maxZoom: 18,
                ext: 'png'
            });
            var ESRI_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
            });
            var ESRI_WorldStreetMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'
            });
                
            var map = L.map('map', {
                center: [18.78, 102.6],
                zoom: 5.2,
                layers: [ESRI_WorldStreetMap],
                zoomControl: false
            });

            L.control.zoom({
                position: 'bottomright'
            }).addTo(map);

            map.on('click', function(e) {
                const cmd = "../ts/?" + 
                    "lat=" + JSON.stringify(e.latlng.lat) + "&" + 
                    "lon=" + JSON.stringify(e.latlng.lng) + "&" +
                    "var=" + document.getElementById("var_select").value + "&" +
                    "forcing_type=" + document.getElementById("forcing_type").value
                console.log(cmd)
                    $.get(cmd,
                    function(res) {
                        console.log(res);
                    }
                )
            })
            </script>
    </body>
</html>